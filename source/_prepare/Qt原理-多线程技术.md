---
title: Qtå®ç”¨æŠ€èƒ½2-ç”¨å¥½qmake
date: 2019-05-29 18:44:23
photos: /img/avatar.jpg
tags: 
    - Qt 
    - QtCreator
    - Qtå®ç”¨æŠ€èƒ½
categories: Qtè¿›é˜¶ä¹‹è·¯
---

- [ç®€ä»‹](#%E7%AE%80%E4%BB%8B)
- [qmakeç®€ä»‹](#qmake%E7%AE%80%E4%BB%8B)
- [æ·»åŠ ç¬¬ä¸‰æ–¹åº“](#%E6%B7%BB%E5%8A%A0%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93)
  - [ç¤ºä¾‹1 - ç›´æ¥é“¾æ¥åº“çš„å…¨è·¯å¾„](#%E7%A4%BA%E4%BE%8B1---%E7%9B%B4%E6%8E%A5%E9%93%BE%E6%8E%A5%E5%BA%93%E7%9A%84%E5%85%A8%E8%B7%AF%E5%BE%84)
  - [ç¤ºä¾‹2 - è·¯å¾„ä¸­åŒ…å«ç©ºæ ¼ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œç”¨å¼•å·æ‹¬èµ·æ¥ã€‚](#%E7%A4%BA%E4%BE%8B2---%E8%B7%AF%E5%BE%84%E4%B8%AD%E5%8C%85%E5%90%AB%E7%A9%BA%E6%A0%BC%E7%AD%89%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E7%94%A8%E5%BC%95%E5%8F%B7%E6%8B%AC%E8%B5%B7%E6%9D%A5)
  - [ç¤ºä¾‹3 - åˆ†åˆ«æŒ‡å®šè·¯å¾„å’Œåº“](#%E7%A4%BA%E4%BE%8B3---%E5%88%86%E5%88%AB%E6%8C%87%E5%AE%9A%E8%B7%AF%E5%BE%84%E5%92%8C%E5%BA%93)
  - [ç¤ºä¾‹4 - åˆ†å¹³å°æ¡ä»¶é“¾æ¥](#%E7%A4%BA%E4%BE%8B4---%E5%88%86%E5%B9%B3%E5%8F%B0%E6%9D%A1%E4%BB%B6%E9%93%BE%E6%8E%A5)
  - [åŸç†](#%E5%8E%9F%E7%90%86)
- [å½±å­æ„å»º](#%E5%BD%B1%E5%AD%90%E6%9E%84%E5%BB%BA)
  - [æŒ‡å®šç›®æ ‡è·¯å¾„](#%E6%8C%87%E5%AE%9A%E7%9B%AE%E6%A0%87%E8%B7%AF%E5%BE%84)
  - [æŒ‡å®šä¸­é—´ä»¶ç”Ÿæˆè·¯å¾„](#%E6%8C%87%E5%AE%9A%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%94%9F%E6%88%90%E8%B7%AF%E5%BE%84)
- [æ‹·è´èµ„æº](#%E6%8B%B7%E8%B4%9D%E8%B5%84%E6%BA%90)
  - [æ‹·è´èµ„æºç¤ºä¾‹](#%E6%8B%B7%E8%B4%9D%E8%B5%84%E6%BA%90%E7%A4%BA%E4%BE%8B)
  - [ç¼–è¯‘å‰æ‹·è´](#%E7%BC%96%E8%AF%91%E5%89%8D%E6%8B%B7%E8%B4%9D)
- [å®‰è£…](#%E5%AE%89%E8%A3%85)
- [ç»“æŸè¯­](#%E7%BB%93%E6%9D%9F%E8%AF%AD)


## ç®€ä»‹

æœ¬æ–‡æ˜¯ã€ŠQtå®ç”¨æŠ€èƒ½ã€‹ç³»åˆ—æ–‡ç« çš„ç¬¬äºŒç¯‡ï¼Œæ¶›å“¥å°†æ•™å¤§å®¶ï¼Œä¸€äº›qmakeçš„å®ç”¨æŠ€å·§ã€‚éƒ¨åˆ†åœ°æ–¹ä¹Ÿä¼šè¯´ä¸€ä¸‹åŸç†ï¼Œè®©å¤§å®¶çŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ã€‚

å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚

è¿™ä¸ªç³»åˆ—ï¼Œå…¨æ˜¯å¹²è´§ï¼

æ³¨ï¼šæ–‡ç« ä¸»è¦å‘å¸ƒåœ¨[æ¶›å“¥çš„åšå®¢](https://jaredtao.github.io) å’Œ [æ¶›å“¥çš„çŸ¥ä¹ä¸“æ -Qtè¿›é˜¶ä¹‹è·¯](https://zhuanlan.zhihu.com/TaoQt)

## qmakeç®€ä»‹

qmakeæ˜¯Qtçš„æ„å»ºå·¥å…·ï¼Œä¸»è¦ä½œç”¨æ˜¯è§£æproæ ¼å¼çš„é¡¹ç›®æ–‡ä»¶ã€ç”Ÿæˆç¼–è¯‘è§„åˆ™(Makefilesæˆ–å…¶å®ƒ)ã€‚

qmakeæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤è€çš„å·¥å…·ï¼Œå¾ˆå¤šåŠŸèƒ½ä½¿ç”¨perlè„šæœ¬å®ç°ï¼Œæ¶›å“¥åœ¨å…¶å®ƒåœ°æ–¹å°±æ²¡æ€ä¹ˆè§è¿‡ä½¿ç”¨perlè„šæœ¬çš„ä»£ç /é¡¹ç›®ã€‚

Qtå®˜æ–¹ä¹‹å‰å¼€å‘çš„Qbsï¼Œåæ¥åˆå®£å¸ƒä¸å†æ›´æ–°ï¼Œç°åœ¨åˆå¤§åŠ›æ”¯æŒCMakeã€‚ã€‚ã€‚

åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼Œqmakeä¾ç„¶æ˜¯å½“ä¸‹ä¸»è¦çš„æ„å»ºå·¥å…·ï¼Œæ‰€ä»¥qmakeçš„ä¸€äº›æŠ€å·§è¿˜æ˜¯æœ‰å¿…è¦æŒæ¡çš„ã€‚

qmakeæœ¬èº«ä½œä¸ºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œä¹Ÿæ˜¯æœ‰ä¸€äº›å‚æ•°çš„ï¼Œä½†è¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œæœ¬æ–‡çš„é‡ç‚¹éƒ½åœ¨proæ–‡ä»¶é‡Œã€‚

proæ–‡ä»¶ä¸­ï¼Œé™¤äº†å¸¸è§„çš„ç»„ç»‡é¡¹ç›®ç»“æ„å¤–ï¼Œè¿˜å¯ä»¥åšå¾ˆå¤šäº‹æƒ…, æ¯”å¦‚ æŒ‡å®šç¼–è¯‘é€‰é¡¹ã€é“¾æ¥é€‰é¡¹ã€åˆ¶å®šç›®æ ‡ç”Ÿæˆè§„åˆ™ã€æ‰©å±•ç¼–è¯‘è§„åˆ™ ç­‰ç­‰ã€‚

proæ–‡ä»¶ä¸­çš„qmakeè¯­æ³•ï¼ŒåŒ…æ‹¬ å˜é‡å£°æ˜å’Œä½¿ç”¨ã€å†…å»ºå˜é‡ã€æ›¿æ¢å‡½æ•°ã€æµ‹è¯•å‡½æ•°ç­‰ï¼Œå¸®åŠ©æ–‡æ¡£éƒ½æœ‰è¯¦ç»†çš„ä»‹ç»ã€‚

æœç´¢å…³é”®è¯ä¸ºqmakeï¼Œ æˆ–è€…å’Œæ™®é€šçš„ç±»æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£æ–¹å¼ä¸€æ ·ï¼Œå…‰æ ‡æ”¾åœ¨proæ–‡ä»¶è¦æŸ¥çœ‹çš„å˜é‡ä¸Šï¼ŒæŒ‰F1å°±èƒ½çœ‹åˆ°ç›¸åº”çš„è¯´æ˜ã€‚

![é¢„è§ˆ](/images/Qt2/3.gif)

æ¶›å“¥å°±ä¸èµ˜è¿°äº†ï¼Œåé¢ç”¨åˆ°çš„ä¼šå•ç‹¬è¯´æ˜ã€‚

## æ·»åŠ ç¬¬ä¸‰æ–¹åº“

c++å¼€å‘ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ä¹Ÿæ˜¯å®¶å¸¸ä¾¿é¥­äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªå¿…å¤‡çš„æŠ€èƒ½ã€‚

è¿™é‡Œé¦–é€‰çš„æ–¹æ³•ï¼Œæ˜¯ä½¿ç”¨QtCreatoræä¾›çš„æ·»åŠ åº“UIã€‚åœ¨proæ–‡ä»¶é‡Œ(æˆ–è€…é¡¹ç›®æ–‡ä»¶å¤¹), é¼ æ ‡å³é”®->æ·»åŠ åº“ï¼Œç„¶åæ ¹æ®è‡ªå·±çš„éœ€è¦ä¸‹ä¸€æ­¥ã€ä¸‹ä¸€æ­¥ç‚¹ä¸€ä¸‹å³å¯ã€‚

![é¢„è§ˆ](/images/Qt2/1.gif)

ç†Ÿç»ƒçš„äººä¹Ÿå¯ä»¥ç›´æ¥æŒ‰proè¯­æ³•(perlè¯­æ³•)å†™ï¼Œç»™LIBSå˜é‡èµ‹å€¼ã€‚

ä¸‹é¢ç»™å‡ ä¸ªç¤ºä¾‹ï¼Œè‡³äºåŠ¨æ€åº“/é™æ€åº“çš„å·®å¼‚ï¼Œå¤§å®¶è‡ªå·±å®è·µå§ã€‚

### ç¤ºä¾‹1 - ç›´æ¥é“¾æ¥åº“çš„å…¨è·¯å¾„
```shell
  LIBS += c:/mylibs/math.lib
```
æˆ‘ä»¬éƒ½çŸ¥é“windowsç³»ç»Ÿé»˜è®¤çš„è·¯å¾„åˆ†å‰²ç¬¦æ˜¯'\'ï¼Œä½†åœ¨qmakeä¸­è¦å†™æˆ'\\'æ‰è¡Œã€‚qmakeä¹Ÿæ”¯æŒå†™æˆ'/'ï¼Œå…¶å®ƒunixç³»ç»Ÿåˆéƒ½æ˜¯'/'ï¼Œ

æ‰€ä»¥å¹²è„†éƒ½å†™æˆ'/'ï¼Œæ–¹ä¾¿å¤„ç†ã€‚

### ç¤ºä¾‹2 - è·¯å¾„ä¸­åŒ…å«ç©ºæ ¼ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œç”¨å¼•å·æ‹¬èµ·æ¥ã€‚
```shell
  LIBS += "C:/mylibs/extra libs/extra.lib"
```

### ç¤ºä¾‹3 - åˆ†åˆ«æŒ‡å®šè·¯å¾„å’Œåº“
```shell
LIBS += "C:/mylibs/extra libs" -lextra
```
è¿™é‡Œçš„LIBSæŒ‡å®šè¦é“¾æ¥çš„åº“ï¼Œ'-L'æ˜¯æŒ‡å®šé“¾æ¥åº“çš„è·¯å¾„ï¼Œ'-l'æŒ‡å®šè¦é“¾æ¥çš„åº“åç§°

åç§°å¯ä»¥çœç•¥libå‰ç¼€å’Œ æ‰©å±•ååç¼€ï¼ŒQtä¼šè‡ªåŠ¨å¤„ç†ã€‚ åç¼€åŒ…æ‹¬ '.so' '.dll' '.dylib' ç­‰ã€‚

### ç¤ºä¾‹4 - åˆ†å¹³å°æ¡ä»¶é“¾æ¥
```shell
  win32:LIBS += "C:/mylibs/extra libs/extra.lib"
  unix:LIBS += "-L/home/user/extra libs" -lextra
```
æ¡ä»¶é“¾æ¥å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°ä¸åŒå¹³å°é“¾æ¥ä¸åŒçš„åº“ã€‚

è¿™é‡Œçš„ win32 unix æ˜¯åœ¨é€‰æ‹©äº†ä¸åŒçš„ç¼–è¯‘å™¨ç¯å¢ƒæ—¶ï¼Œqmakeåˆ†åˆ«é¢„ç½®çš„å˜é‡ã€‚

(æ¯”å¦‚win32å¹³å°ç›¸å…³çš„å˜é‡ï¼Œå¯ä»¥å‚è€ƒmsvcçš„é…ç½®æ–‡ä»¶:  [QTDIR]/mkspecs/win32-msvc/qmake.conf å’Œ [QTDIR]/mkspecs/common/msvc-desktop.conf)

### åŸç†

Qtå†…ç½®äº†ä¸€äº›perlè„šæœ¬ï¼Œåœ¨æ‰§è¡Œqmakeè§£ææ—¶ä¼šåŒ…å«è¿™äº›è„šæœ¬ã€‚å…¶ä¸­ä¸€äº›è„šæœ¬ä¼šæ¥å¤„ç†è¿™ä¸ªLIBSå˜é‡ï¼Œå°†å…¶è½¬æ¢æˆç¼–è¯‘å™¨/é“¾æ¥å™¨çš„å‚æ•°ã€‚

å†…ç½®çš„è„šæœ¬è·¯å¾„åœ¨[QTDIR]/mkspecs/featuresæ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰©å±•åä¸ºprfã€‚

![é¢„è§ˆ](/images/Qt2/2.png)

åç»­çš„å¾ˆå¤šå˜é‡ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„åŸç†, åªæ˜¯å¤„ç†æ–¹å¼å„ä¸ç›¸åŒã€‚

å¾ˆå¤šproæ–‡ä»¶çš„è¯­æ³•ã€åŠŸèƒ½å®ç°ï¼Œéƒ½å¯ä»¥å‚è€ƒè¿™äº›prfæ¥å®ç°ã€‚

(æ³¨æ„ï¼šä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œä¸è¦ä¹±æ”¹prfï¼Œå®¹æ˜“æ”¹å)

Qtç¨‹åºå‘˜éƒ½çŸ¥é“çš„ä¸€ä»¶äº‹ï¼šæœ‰æ—¶å€™ä¿®æ”¹äº†ä¿¡å·/æ§½ç›¸å…³çš„ä»£ç ï¼Œä¸èƒ½æ­£å¸¸è¿è¡Œï¼Œè¦é‡æ–°qmakeä¸€ä¸‹ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚

æœ¬è´¨ä¸Šå°±æ˜¯åœ¨é‡æ–°è§¦å‘[QTDIR]/mkspecs/features/moc.prfè¿™ä¸ªè„šæœ¬ã€‚

(å¤šå°‘å¹´äº†ï¼Œéƒ½æ²¡æœ‰ä¿®å¥½Mocç”Ÿæˆé—®é¢˜ï¼Œå¯è§qmakeçš„å¤è€...)

## å½±å­æ„å»º

å½±å­æ„å»ºï¼Œå°±æ˜¯ç¼–è¯‘ç”Ÿæˆçš„äº§ç‰©å’Œæºä»£ç åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æºä»£ç æ–‡ä»¶å¤¹è¢«æ±¡æŸ“ã€‚

QtCreatoré»˜è®¤å¯¼å…¥proå·¥ç¨‹æ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå½±å­æ„å»ºè·¯å¾„ã€‚æ¯”å¦‚è¿™æ ·ï¼š

![é¢„è§ˆ](/images/Qt2/4.png)

```
F:\Dev\Qt\build-HelloTaoQuick-Desktop_Qt_5_12_3_MSVC2017_64bit-Debug
```
ä¹‹åç¼–è¯‘é¡¹ç›®æ—¶ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶åŠç›®æ ‡æ–‡ä»¶ï¼Œéƒ½åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚

è¿™ä¸ªè·¯å¾„å¾ˆé•¿ï¼Œè€Œä¸”ç¼–è¯‘å™¨æˆ–è€…ç¼–è¯‘é€‰é¡¹ä¸åŒæ—¶éƒ½æœ‰å¯èƒ½ä¸ä¸€æ ·ã€‚

æœ‰æ—¶å€™è¦åšä¸€äº›ç‰¹å®šçš„æ“ä½œ æ¯”å¦‚ç›®æ ‡exeç”Ÿæˆåˆ°ç‰¹å®šç›®å½•ã€æ‹·è´èµ„æºæ–‡ä»¶ç­‰ç­‰ï¼Œç›´æ¥ç”¨è¿™ä¸ªè·¯å¾„ä¼šä¸å¤ªæ–¹ä¾¿/ä¸å¤ªå¯é ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›å®šåˆ¶ã€‚

### æŒ‡å®šç›®æ ‡è·¯å¾„

```shell
DESTDIR = $$PWD/bin
```
é€šè¿‡ç»™DESTDIRå˜é‡èµ‹å€¼ï¼Œ å¯ä»¥æŒ‡å®šç”Ÿæˆçš„lib/exeæ”¾åœ¨å“ªä¸ªç›®å½•ä¸‹

'PWD'æ˜¯qmakeå†…ç½®å˜é‡ï¼Œ'$$'æ˜¯å†…ç½®å˜é‡å–å€¼çš„å†™æ³•ã€‚'/bin'æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥åœ¨å˜é‡åé¢ã€‚

æ›´å¤šå†…ç½®å˜é‡å¯ä»¥å‚è€ƒqmakeå¸®åŠ©æ–‡æ¡£ï¼Œä»¥åŠè¿™ç¯‡æ–‡æ¡£[éšè—çš„qmakeæ–‡æ¡£](https://wiki.qt.io/Undocumented_QMake)

å½“ç„¶ä¹Ÿå¯ä»¥å‚è€ƒé‚£ä¸€å †prfå’Œconfæ–‡ä»¶ã€‚

### æŒ‡å®šä¸­é—´ä»¶ç”Ÿæˆè·¯å¾„

å¯ä»¥é€šè¿‡è¿™å‡ ä¸ªå˜é‡æŒ‡å®šä¸­é—´ä»¶ç”Ÿæˆçš„è·¯å¾„

```qmake
config(debug, debug|release) {
    OBJECTS_DIR = build/debug/obj
    MOC_DIR = build/debug/moc
    RCC_DIR = build/debug/rcc
    UI_DIR = build/debug/uic
} else {
    OBJECTS_DIR = build/release/obj
    MOC_DIR = build/release/moc
    RCC_DIR = build/release/rcc
    UI_DIR = build/release/uic
}

```

config(debug, debug|release) æ˜¯ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œå¯ä»¥ç†è§£ä¸º 

```qmake
if (debug === true) {

} else if (release == true) {

}
```
æ³¨æ„: æŒ‰ç…§perlè¯­æ³•ï¼Œé‚£ä¸ªå·¦å¤§æ‹¬å·'{'ä¸èƒ½æ¢è¡Œ,è¦å’Œå‰é¢çš„è¡¨è¾¾å¼åœ¨åŒä¸€è¡Œã€‚(æœ‰äººè‡ªä½œèªæ˜æ¢è¡Œï¼Œè¢«å‘äº†å‘¢ğŸ˜„)

ä¸Šé¢è¿™ç§æŒ‡å®šä¸­é—´ä»¶è·¯å¾„çš„æ–¹å¼ï¼Œåœ¨QtCreatorä¸­æœ‰é»˜è®¤è·¯å¾„æ‰€ä»¥æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œä¸è¿‡åœ¨å‘½ä»¤è¡Œç¼–è¯‘æ—¶è¿™æ ·å†™å´å¾ˆæœ‰ç”¨ã€‚

## æ‹·è´èµ„æº

proå¯ä»¥å®ç°ï¼Œåœ¨ç¼–è¯‘ä»£ç æ—¶ï¼Œæ‹·è´ä¸€äº›æ–‡ä»¶åˆ°æŒ‡å®šçš„è·¯å¾„ä¸‹

### æ‹·è´èµ„æºç¤ºä¾‹

è¿™é‡Œä»¥TaoQuickä¸ºä¾‹,æ¥è¯´æ˜ï¼š

æˆ‘åœ¨TaoQuickåº“ç›®å½•ä¸‹ï¼Œæœ‰ä¸ªå«qmldirçš„æ–‡ä»¶ï¼Œéœ€è¦åœ¨ç¼–è¯‘ä»£ç æ—¶è‡ªåŠ¨æ‹·è´åˆ°binç›®å½•ä¸‹ã€‚(å…ˆåˆ«ç®¡è¿™ä¸ªæ–‡ä»¶å¹²å˜›çš„ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« ä¼šè¯´)

![é¢„è§ˆ](/images/Qt2/5.png)

å…³é”®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š
```
TaoQuick
    TaoQuick.pro
    - bin
        -TaoQuick
    - TaoQuickCore
        TaoQuickCore.pro
        - Qml
            qmldir
```
é‚£ä¹ˆæˆ‘åœ¨TaoQuickCore.proæ–‡ä»¶ä¸­çš„å†™æ³•å¦‚ä¸‹ï¼š

```shell
!equals(_PRO_FILE_PWD_, $$DESTDIR) {
    copy_qmldir.target = $$DESTDIR/qmldir
    copy_qmldir.depends = $$_PRO_FILE_PWD_/qmldir
    win32 {
        copy_qmldir.target ~= s,/,\\\\,g
        copy_qmldir.depends ~= s,/,\\\\,g
    }
    copy_qmldir.commands = $${QMAKE_COPY_FILE} $${copy_qmldir.depends} $${copy_qmldir.target}
    QMAKE_EXTRA_TARGETS += copy_qmldir
}

```
â€˜!equals(_PRO_FILE_PWD_, $$DESTDIR)â€™ è¿™ä¸€å¥æ˜¯æ‰§è¡Œæ¡ä»¶ï¼Œå³: ç›®æ ‡è·¯å¾„ä¸ç­‰äºproæ–‡ä»¶æ‰€åœ¨è·¯å¾„æ—¶ æ‰§è¡Œä¸‹é¢çš„æ“ä½œã€‚

å‰©ä¸‹çš„äº‹æƒ…å°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ª"ç¼–è¯‘ç›®æ ‡"ï¼ˆTargetï¼‰ï¼Œå°†è¿™ä¸ªç¼–è¯‘ç›®æ ‡æ·»åŠ åˆ°QMAKE_EXTRA_TARGETSå˜é‡ä¸­å°±è¡Œäº†ã€‚

ç†Ÿæ‚‰MakeFilesçš„åŒå­¦åº”è¯¥éƒ½æ¸…æ¥šä»€ä¹ˆæ˜¯"ç›®æ ‡"ã€‚ä¸æ‡‚MakeFilesä¹Ÿæ²¡å…³ç³»ï¼Œè¿™é‡Œçš„ç›®æ ‡å°±ç†è§£ä¸ºè‡ªå·±å£°æ˜çš„ä¸€ä¸ªå˜é‡å³å¯ã€‚

è¿™ä¸ªå˜é‡æœ‰ä¸‰ä¸ªå¾ˆé‡è¦çš„"å­å˜é‡":

copy_qmldir.target æŒ‡å®šç›®æ ‡æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„   (è¿™é‡Œç†è§£æˆè¦æ‹·è´åˆ°å“ªå»)
copy_qmldir.depends æŒ‡å®šä¾èµ–æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„  (è¿™é‡Œç†è§£æˆä»å“ªé‡Œæ‹·è´)
copy_qmldir.commands æŒ‡å®šæ‹·è´æ“ä½œçš„æ‰§è¡Œå‘½ä»¤ (å°±æ˜¯æ€ä¹ˆæ‹·è´)

QMAKE_COPY_FILE è¿™ä¸ªå˜é‡æ¥è‡ªå‰é¢è¯´è¿‡çš„[éšè—çš„qmakeæ–‡æ¡£](https://wiki.qt.io/Undocumented_QMake)

qmakeä¼šåœ¨è§£æproæ–‡ä»¶æ—¶ï¼Œè‡ªåŠ¨æ›¿æ¢æˆå¹³å°ç›¸åº”çš„æ‹·è´å‘½ä»¤ã€‚ windows å¹³å°å°±æ˜¯ copy /y

æ³¨æ„windowsçš„copyæŒ‡ä»¤ï¼Œè·¯å¾„åˆ†éš”ç¬¦å¾—å†™æˆ '\\'æ‰è¡Œã€‚æ‰€ä»¥æœ‰äº†ä¸‹é¢çš„ç‰¹æ®Šå¤„ç†ï¼š

```
    win32 {
        copy_qmldir.target ~= s,/,\\\\,g
        copy_qmldir.depends ~= s,/,\\\\,g
    }
```
â€˜s,/,\\\\,gâ€™ æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä½œç”¨æ˜¯æŠŠâ€˜/â€™æ›¿æ¢æˆâ€˜\\â€™ ã€‚sè¡¨ç¤ºå¼€å¤´ï¼Œgè¡¨ç¤ºç»“å°¾ã€‚

VAR~= REGEXP æ˜¯å¯¹å˜é‡VARæ‰§è¡ŒREGEXPè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼

### ç¼–è¯‘å‰æ‹·è´

å¦‚æœæƒ³åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œå…ˆæŠŠèµ„æºæ‹·è´å®Œæˆï¼Œåªéœ€è¦å‰é¢çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ ä¸€å¥

```
    PRE_TARGETDEPS += $$copy_qmldir.target
```
ä¹Ÿå°±æ˜¯æŠŠ"ç›®æ ‡"åŠ åˆ° PRE_TARGETDEPSå˜é‡

```shell
!equals(_PRO_FILE_PWD_, $$DESTDIR) {
    copy_qmldir.target = $$DESTDIR/qmldir
    copy_qmldir.depends = $$_PRO_FILE_PWD_/qmldir
    win32 {
        copy_qmldir.target ~= s,/,\\\\,g
        copy_qmldir.depends ~= s,/,\\\\,g
    }
    copy_qmldir.commands = $${QMAKE_COPY_FILE} $${copy_qmldir.depends} $${copy_qmldir.target}
    QMAKE_EXTRA_TARGETS += copy_qmldir
    PRE_TARGETDEPS += $$copy_qmldir.target
}

```

## å®‰è£…

proä¸­è¿˜æœ‰ä¸€ç§INSTALLåŠŸèƒ½ï¼Œå¯ä»¥æ‰§è¡Œæ–‡ä»¶æ‹·è´ã€‚

å’Œç¼–è¯‘æœŸæ‹·è´ ç±»ä¼¼ï¼ŒINSTALLç”¨èµ·æ¥æ›´ç®€å•æ— è„‘ä¸€äº›ï¼Œè€Œä¸”INSTALLåªåœ¨æ‰§è¡Œmake installæŒ‡ä»¤æ—¶ï¼Œæ‰ä¼šæ‹·è´èµ„æºã€‚

è¿˜æ˜¯ä»¥TaoQuickä¸ºä¾‹, æˆ‘æœ‰ä¸€å †æ–‡ä»¶ï¼Œéœ€è¦åœ¨make installæ—¶ï¼Œå®‰è£…åˆ°Qtçš„Qmlè·¯å¾„ä¸­

![é¢„è§ˆ](/images/Qt2/6.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºæ‰€æœ‰çš„æ–‡ä»¶, é™¤äº†TaoQuickDesigner.pri, éƒ½è¦æŒ‰ç…§è¿™ä¸ªç»“æ„æ‹·è´ã€‚

(è¿™ä¸ªpriæ–‡ä»¶æ˜¯proæ–‡ä»¶çš„ä¸€å°éƒ¨åˆ†ï¼Œå¯ä»¥ç›´æ¥åœ¨proä¸­é€šè¿‡includeå¼•å…¥ã€‚

priå’Œproè¯­æ³•ä¸€æ ·ï¼Œä½†æ˜¯qmakeä¸ç›´æ¥è¯†åˆ«priï¼Œåªè¯†åˆ«pro

priä¸€èˆ¬ç”¨æ¥å†™ä¸€äº›å…¬ç”¨çš„éƒ¨åˆ†ï¼Œè®©å¤šä¸ªproå…¬ç”¨)

æ‹·è´æ•´ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸€ç§åšæ³•, å½“ç„¶ä¸ºäº†ç²¾ç¡®åœ°æ§åˆ¶è¦æ‹·è´çš„å†…å®¹ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š

```
taoquick_designer.files = $$PWD/designer/TaoQuick.metainfo
taoquick_designer.path = $$[QT_INSTALL_QML]/$${uri}/designer

toaquick_qmldir.files = $$PWD/qmldir
toaquick_qmldir.path = $$[QT_INSTALL_QML]/$${uri}

taoquick_qml_buttons.files = $$PWD/BasicComponent/Button/*.qml
taoquick_qml_buttons.path = $$[QT_INSTALL_QML]/$${uri}/BasicComponent/Button

taoquick_qml_mouse.files = $$PWD/BasicComponent/Mouse/*.qml
taoquick_qml_mouse.path = $$[QT_INSTALL_QML]/$${uri}/BasicComponent/Mouse

taoquick_qml_others.files = $$PWD/BasicComponent/Others/*.qml
taoquick_qml_others.path = $$[QT_INSTALL_QML]/$${uri}/BasicComponent/Others

taoquick_qml_progress.files = $$PWD/BasicComponent/Progress/*.qml
taoquick_qml_progress.path = $$[QT_INSTALL_QML]/$${uri}/BasicComponent/Progress

taoquick_degisner_images.files = $$PWD/designer/images/*.png
taoquick_degisner_images.path = $$[QT_INSTALL_QML]/$${uri}/designer/images

INSTALLS  += taoquick_designer toaquick_qmldir taoquick_qml_buttons taoquick_qml_mouse taoquick_qml_others taoquick_qml_progress taoquick_degisner_images

```
è‡ªå®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œç„¶åå…¶å­å˜é‡filesæŒ‡å®šè¦æ‹·è´çš„æ–‡ä»¶ï¼Œå­å˜é‡pathæŒ‡å®šç›®æ ‡è·¯å¾„ã€‚

æŠŠè‡ªå®šä¹‰å˜é‡åŠ å…¥INSTALLSå˜é‡å°±è¡Œäº†ã€‚

QT_INSTALL_QMLä¹Ÿæ˜¯ä¸€ä¸ªå†…ç½®å˜é‡ï¼Œé»˜è®¤å€¼ä¸º[QTDIR]/qmlã€‚

ä¹‹ååªè¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°±èƒ½å®Œæˆèµ„æºæ‹·è´ã€‚
```shell
qmake
make 
make install
```

å½“ç„¶QtCreatorä¸­ä¹Ÿèƒ½æ‰§è¡Œmake install

å¦‚ä¸‹å›¾æ‰€ç¤º:

![é¢„è§ˆ](/images/Qt2/QtCreator-install.png)

ä»»æ„ç¼–è¯‘å™¨kitéƒ½å¯ä»¥ï¼Œé¡¹ç›®->æ„å»ºæ­¥éª¤->æ·»åŠ buildæ­¥éª¤->Makeï¼Œæ·»åŠ ä¹‹ååœ¨makeå‚æ•°ä¸­è¾“å…¥installã€‚æœ€åé‡æ–°æ„å»ºå·¥ç¨‹ï¼Œå³å¯å®Œæˆå®‰è£…ã€‚

## ç»“æŸè¯­

ä»¥ä¸Šæ¡ˆä¾‹ï¼Œå¤§éƒ¨åˆ†éƒ½åœ¨TaoQuické¡¹ç›®ä¸­å®è·µè¿‡ï¼Œå¯ä»¥å»Githubå‚è€ƒã€‚

[TaoQuick](https://github.com/jaredtao/TaoQuick)